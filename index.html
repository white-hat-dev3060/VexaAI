<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vexa AI</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://unpkg.com/@phosphor-icons/web"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Fira+Code:wght@400&display=swap" rel="stylesheet">
<style>
html, body { height:100%; height:100dvh; overscroll-behavior:none; }
::-webkit-scrollbar { width:6px; height:6px; }
::-webkit-scrollbar-thumb { background:#cbd5e1; border-radius:3px; }
.dark ::-webkit-scrollbar-thumb { background:#374151; }
.prose pre { background-color:#1e1e1e !important; padding:1rem;border-radius:.5rem;overflow-x:auto; }
.prose code { color:#93c5fd;background-color: rgba(255,255,255,0.1); padding:.1rem .3rem; border-radius:.2rem;font-size:.9em; }
.prose pre code { background-color:transparent; padding:0; }
.loader { border:4px solid #f3f3f3; border-top:4px solid #3498db; border-radius:50%; width:40px;height:40px;animation:spin 1s linear infinite; }
@keyframes spin {0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
</style>
</head>
<body class="bg-white dark:bg-[#131314] text-gray-800 dark:text-gray-100 transition-colors duration-200">

<div id="loading" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-white dark:bg-[#131314]">
  <div class="loader mb-4"></div>
  <div class="text-sm font-medium text-gray-500">Initializing Vexa AI...</div>
</div>

<div id="app" class="flex h-full h-[100dvh] overflow-hidden hidden">

  <aside id="sidebar" class="fixed lg:static inset-y-0 left-0 w-72 bg-gray-50 dark:bg-[#1E1E1E] border-r border-gray-700 flex flex-col z-30">
    <div class="p-4 flex items-center justify-between border-b border-gray-200 dark:border-gray-700">
      <button onclick="createNewChat()" class="flex-1 flex items-center gap-2 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 px-4 py-2.5 rounded-full text-sm font-medium transition-colors">
        <i class="ph ph-plus text-lg"></i> <span>New Chat</span>
      </button>
    </div>
    <div id="chatHistory" class="flex-1 overflow-y-auto p-3 space-y-1"></div>
    <div class="p-4 border-t border-gray-700 space-y-2">
      <button onclick="toggleDarkMode()" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 text-sm transition-colors">
        <i id="themeIcon" class="ph ph-moon text-lg"></i>
        <span id="themeText">Dark Mode</span>
      </button>
    </div>
  </aside>

  <main class="flex-1 flex flex-col h-full w-full relative">
    <div id="messagesContainer" class="flex-1 overflow-y-auto p-4 md:p-8 space-y-6 scroll-smooth">
      <div id="welcomeState" class="h-full flex flex-col items-center justify-center text-center">
        <div class="w-16 h-16 bg-gradient-to-tr from-blue-500 to-purple-500 rounded-2xl mb-6 shadow-lg animate-pulse"></div>
        <h1 id="welcomeName" class="text-2xl md:text-4xl font-semibold mb-2 bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600">Hello, User</h1>
        <p class="text-gray-500 dark:text-gray-400 max-w-md">I am Vexa AI, your personal assistant.</p>
        <p class="text-gray-400 text-xs mt-2">Created & owned by <strong>Ismail Yazddan</strong></p>
      </div>
    </div>

    <div class="p-4 bg-white dark:bg-[#131314]">
      <div class="max-w-4xl mx-auto relative group">
        <textarea id="promptInput" rows="1" placeholder="Ask anything..."
          class="w-full bg-gray-100 dark:bg-[#1E1E1E] text-gray-900 dark:text-white rounded-3xl pl-5 pr-14 py-4 focus:outline-none focus:ring-2 focus:ring-blue-500/50 resize-none overflow-hidden max-h-48 transition-all"
          oninput="autoResize(this)" onkeydown="handleEnter(event)"></textarea>
        <button id="sendBtn" onclick="sendMessage()" class="absolute right-2 bottom-2 p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-all w-10 h-10 flex items-center justify-center">
          <i class="ph ph-paper-plane-right text-lg"></i>
        </button>
      </div>
    </div>
  </main>
</div>

<script>
// ======================
// App State
// ======================
const state = { chats: [], currentChatId: null, isGenerating: false, darkMode: false };
const els = { app:document.getElementById('app'), loading:document.getElementById('loading'), messagesContainer:document.getElementById('messagesContainer'), welcomeState:document.getElementById('welcomeState'), welcomeName:document.getElementById('welcomeName'), promptInput:document.getElementById('promptInput'), sendBtn:document.getElementById('sendBtn'), chatHistory:document.getElementById('chatHistory'), themeIcon:document.getElementById('themeIcon'), themeText:document.getElementById('themeText') };

// ======================
// Ask User Name
// ======================
let userName = prompt("Hi! What's your name?") || "User";
els.welcomeName.innerText = "Hello, "+userName;
setTimeout(()=>{els.loading.classList.add('opacity-0','pointer-events-none'); els.app.classList.remove('hidden'); setTimeout(()=>els.loading.remove(),500);},500);

// ======================
// Sidebar & Chats
// ======================
function createNewChat(){ const newChat={id:Date.now().toString(),title:'New Chat',messages:[],timestamp:Date.now()}; state.chats.unshift(newChat); state.currentChatId=newChat.id; renderSidebar(); renderMessages(); els.promptInput.focus(); }
function renderSidebar(){ els.chatHistory.innerHTML=state.chats.map(chat=>`<div onclick="selectChat('${chat.id}')" class="group flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors"><div class="flex items-center gap-3 overflow-hidden"><i class="ph ph-chat-circle text-lg shrink-0"></i><span class="text-sm font-medium truncate">${chat.title}</span></div></div>`).join(''); }
function selectChat(id){ state.currentChatId=id; renderMessages(); }
function renderMessages(){ if(!state.currentChatId){ els.messagesContainer.appendChild(els.welcomeState); return; } const chat=state.chats.find(c=>c.id===state.currentChatId); els.welcomeState.style.display='none'; els.messagesContainer.innerHTML=chat.messages.map(msg=>`<div class="flex flex-col ${msg.role==='user'?'items-end':'items-start'} animate-fade-in"><div class="max-w-[85%] md:max-w-[75%] rounded-2xl px-5 py-3.5 ${msg.role==='user'?'bg-gray-100 dark:bg-[#2A2A2A] text-gray-900 dark:text-gray-100 rounded-br-none':'text-gray-800 dark:text-gray-200 prose dark:prose-invert w-full'}">${msg.role==='user'?escapeHtml(msg.content):marked.parse(msg.content)}</div></div>`).join(''); document.querySelectorAll('pre code').forEach(block=>{hljs.highlightElement(block);}); scrollToBottom(); }

// ======================
// Send Message (hidden API)
// ======================
const HIDDEN_API_KEY = "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"; // <-- Put your key here
async function sendMessage(){
  const text=els.promptInput.value.trim(); if(!text||state.isGenerating)return; if(!state.currentChatId) createNewChat();
  const chat=state.chats.find(c=>c.id===state.currentChatId);
  chat.messages.push({role:'user', content:text}); renderMessages(); els.promptInput.value=''; els.promptInput.style.height='auto';
  state.isGenerating=true; els.sendBtn.disabled=true;

  try {
    const response=await fetch('https://api.openai.com/v1/chat/completions',{ method:'POST', headers:{'Content-Type':'application/json','Authorization':'Bearer '+HIDDEN_API_KEY}, body:JSON.stringify({model:'gpt-3.5-turbo', messages:[{role:'user', content:text}]})});
    const data=await response.json();
    const reply=data.choices[0].message.content;
    chat.messages.push({role:'assistant', content:reply}); renderMessages();
  } catch(err){ chat.messages.push({role:'assistant', content:'Sorry, Vexa could not get response.'}); renderMessages(); }
  finally{ state.isGenerating=false; els.sendBtn.disabled=false; }
}

// ======================
// Helpers
// ======================
function handleEnter(e){ if(e.key==='Enter'&&!e.shiftKey){ e.preventDefault(); sendMessage(); } }
function autoResize(el){ el.style.height='auto'; el.style.height=el.scrollHeight+'px'; }
function scrollToBottom(){ els.messagesContainer.scrollTo({top:els.messagesContainer.scrollHeight, behavior:'smooth'}); }
function escapeHtml(text){ const div=document.createElement('div'); div.textContent=text; return div.innerHTML.replace(/\n/g,'<br'); }

// ======================
// Dark/Light Mode
// ======================
function toggleDarkMode(){
  state.darkMode=!state.darkMode; document.documentElement.classList.toggle('dark',state.darkMode);
  els.themeText.innerText = state.darkMode ? 'Light Mode' : 'Dark Mode';
  els.themeIcon.className = state.darkMode ? 'ph ph-sun text-lg' : 'ph ph-moon text-lg';
}
</script>
</body>
          </html>
